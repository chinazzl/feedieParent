<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.foodieshop.mapper.ItemsCommentsMapper">
    <!--<resultMap id="BaseResultMap" type="com.foodieshop.pojo.ItemsComments" >
      &lt;!&ndash;
        WARNING - @mbg.generated
      &ndash;&gt;
      <id column="id" property="id" jdbcType="VARCHAR" />
      <result column="user_id" property="userId" jdbcType="VARCHAR" />
      <result column="item_id" property="itemId" jdbcType="VARCHAR" />
      <result column="item_name" property="itemName" jdbcType="VARCHAR" />
      <result column="item_spec_id" property="itemSpecId" jdbcType="VARCHAR" />
      <result column="sepc_name" property="sepcName" jdbcType="VARCHAR" />
      <result column="comment_level" property="commentLevel" jdbcType="INTEGER" />
      <result column="content" property="content" jdbcType="VARCHAR" />
      <result column="created_time" property="createdTime" jdbcType="TIMESTAMP" />
      <result column="updated_time" property="updatedTime" jdbcType="TIMESTAMP" />
    </resultMap>-->
    <select id="queryCommentsByItemId" parameterType="map" resultType="com.foodieshop.vo.CommentRecord">
        SELECT
            IC.comment_level AS commentLevel,
            ic.content AS content,
            ic.sepc_name AS specName,
            ic.created_time AS createdTime,
            u.face AS userFace,
            u.nickname AS nickName
        FROM
            items_comments IC
        LEFT JOIN USERS U
            ON IC.user_id = U.ID
        WHERE
            IC.item_id = #{paramMap.itemId}
            <if test="paramMap.level != null and paramMap.level != ''">
                AND IC.comment_level = #{paramMap.level}
            </if>
    </select>

</mapper>